<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>CakeBot Control Panel</title>
<style>
:root{
  --accent-green:#28B463;
  --accent-blue:#4285f4;
  --accent-red:#e74c3c;
  --accent-yellow:#f1c40f;
  --panel-bg:#ffffffcf;
}
body{
  margin:0;
  font-family:"Inter","Segoe UI",sans-serif;
  background:linear-gradient(135deg,#cce5ff,#e5d6ff);
  display:flex;flex-direction:column;align-items:center;
  height:100vh;overflow:hidden;
}
.status-bar{
  width:100%;text-align:center;color:#fff;font-weight:700;
  font-size:1.05rem;padding:.6rem 0;
  letter-spacing:.2px;box-shadow:0 2px 4px rgba(0,0,0,0.08);
}
.status-bar.off{background:#555;}
.status-bar.on{background:var(--accent-green);}
.status-bar.notcalibrated{background:var(--accent-yellow);color:#000;}
.status-bar.printing{background:var(--accent-blue);}
.status-bar.emergency{background:var(--accent-red);}

main{
  display:grid;
  grid-template-rows:auto minmax(250px,70vh) auto;
  width:95%;max-width:960px;
  margin-top:.8rem;
  background:var(--panel-bg);
  backdrop-filter:blur(6px);
  border-radius:12px;
  padding:1rem 1.2rem;
  box-shadow:0 0 14px rgba(0,0,0,0.1);
}

/* top bar */
.system-controls{
  display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;
  margin-bottom:.8rem;
}
.buttons{display:flex;gap:.8rem;}
.status-cluster{
  display:flex;align-items:center;gap:.8rem;flex-wrap:wrap;justify-content:flex-end;
}

/* buttons + LED */
button{
  border:none;border-radius:6px;padding:.55rem 1.1rem;color:#fff;
  font-weight:600;cursor:pointer;font-size:.95rem;transition:.2s;
}
button:disabled{opacity:.4;cursor:not-allowed;}
#calibrate{background:var(--accent-blue);}
#print{background:var(--accent-green);}
#reset{background:var(--accent-blue);}
#emergency{background:var(--accent-red);}
#power{
  background:#333;border-radius:50%;width:40px;height:40px;
  display:flex;align-items:center;justify-content:center;font-size:1.1rem;
}
#power.active{background:var(--accent-green);}
.led{
  display:flex;align-items:center;gap:.45rem;font-size:.9rem;
  min-width:230px;white-space:nowrap;
}
.led-indicator{
  width:16px;height:16px;border-radius:50%;
  background:var(--accent-red);
  box-shadow:0 0 6px var(--accent-red);
}
.led-indicator.yellow{background:var(--accent-yellow);box-shadow:0 0 6px var(--accent-yellow);}
.led-indicator.green{background:var(--accent-green);box-shadow:0 0 6px var(--accent-green);}

/* viewport */
.viewport{
  width:100%;aspect-ratio:1/1;max-height:70vh;
  position:relative;
  background:radial-gradient(circle,#f2f2f2,#d8d8d8);
  border:2px solid #555;border-radius:10px;overflow:hidden;
}
.text-overlay{
  position:absolute;top:35%;left:30%;font-size:28px;font-weight:700;color:#222;
  background-color:rgba(255,255,255,0.7);
  padding:6px 10px;border:1px dashed #333;border-radius:4px;cursor:grab;user-select:none;
}
.text-overlay.editing{cursor:text;border-style:solid;}

/* bottom font area */
.text-config{
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-wrap:wrap;
  background:#fafbfd;
  border-top:1px solid #ccc;
  padding:0.8rem 0;
  margin-top:0.8rem;
  border-radius:0 0 10px 10px;
}
.font-row{
  display:flex;
  align-items:center;
  gap:0.8rem;
  flex-wrap:wrap;
}
.font-row label{
  font-weight:700;
  font-size:0.95rem;
  color:#333;
  margin-right:0.3rem;
}
.font-row select,
.font-row input[type=range]{
  border:1px solid #bbb;
  border-radius:6px;
  padding:0.35rem 0.5rem;
  font-size:0.9rem;
}
.font-size-label{
  margin-left:1rem;
}
#settingsBtn{
  background:var(--accent-blue);
  color:#fff;
  font-weight:600;
  border:none;
  border-radius:8px;
  padding:.55rem 1.8rem;
  font-size:1rem;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
  transition:0.25s;
}
#settingsBtn:hover{
  background:#2c6ed4;
  transform:translateY(-1px);
}
</style>
</head>

<body>
<div id="statusBar" class="status-bar off">PRESS POWER BUTTON TO START</div>

<main>
  <!-- top controls -->
  <div class="system-controls">
    <div class="buttons">
      <button id="calibrate" disabled>Calibrate</button>
      <button id="print" disabled>Print Cake</button>
    </div>
    <div class="status-cluster">
      <div class="led">
        <div class="led-indicator" id="systemLED"></div>
        <span id="ledStatusMsg">System OFF</span>
      </div>
      <button id="power">⏻</button>
      <button id="reset" disabled>Reset</button>
      <button id="emergency" disabled>Emergency Stop</button>
    </div>
  </div>

  <!-- main viewport -->
  <div class="viewport" id="viewport">
    <div class="text-overlay" id="textOverlay">Happy Birthday!</div>
  </div>

  <!-- bottom bar -->
  <section class="text-config">
    <div class="font-row">
      <label for="fontSelect">Font:</label>
      <select id="fontSelect">
        <option value="'Comic Sans MS',cursive">Comic Sans</option>
        <option value="cursive">Cursive</option>
        <option value="'Courier New',monospace">Courier</option>
        <option value="serif">Serif</option>
        <option value="sans-serif" selected>Helve Cursive</option>
      </select>

      <label for="fontSizeRange" class="font-size-label">Font Size:</label>
      <input id="fontSizeRange" type="range" min="8" max="120" value="28">
    </div>
    <button id="settingsBtn">Settings</button>
  </section>
</main>

<script>
const statusBar=document.getElementById("statusBar"),
systemLED=document.getElementById("systemLED"),
ledMsg=document.getElementById("ledStatusMsg"),
powerBtn=document.getElementById("power"),
resetBtn=document.getElementById("reset"),
calibrateBtn=document.getElementById("calibrate"),
printBtn=document.getElementById("print"),
emergencyBtn=document.getElementById("emergency"),
settingsBtn=document.getElementById("settingsBtn"),
textOverlay=document.getElementById("textOverlay"),
viewport=document.getElementById("viewport"),
fontSelect=document.getElementById("fontSelect"),
fontSizeRange=document.getElementById("fontSizeRange");

let powerOn=false,calibrated=false,emergencyActive=false;

/* --- Updated status‑bar messages --- */
function updateStatus(){
  if(emergencyActive){
    systemLED.className="led-indicator";
    ledMsg.textContent="Emergency STOP";
    statusBar.textContent="EMERGENCY STOP ACTIVATED";
    statusBar.className="status-bar emergency";
    return;
  }
  if(!powerOn){
    systemLED.className="led-indicator";
    ledMsg.textContent="System OFF";
    statusBar.textContent="PRESS POWER BUTTON TO START";
    statusBar.className="status-bar off";
    return;
  }
  if(powerOn&&!calibrated){
    systemLED.className="led-indicator yellow";
    ledMsg.textContent="On – Not Calibrated";
    statusBar.textContent="SYSTEM CALIBRATION REQUIRED";
    statusBar.className="status-bar notcalibrated";
    return;
  }
  systemLED.className="led-indicator green";
  ledMsg.textContent="System Ready";
  statusBar.textContent="SYSTEM READY FOR PRINTING";
  statusBar.className="status-bar on";
}

/* controls enable/disable */
function setControls(enabled){
  calibrateBtn.disabled=!enabled;
  printBtn.disabled=!enabled;
  resetBtn.disabled=!enabled;
  emergencyBtn.disabled=!enabled;
}

/* Power */
powerBtn.onclick=()=>{
  powerOn=!powerOn;powerBtn.classList.toggle("active",powerOn);
  if(powerOn){
    calibrated=false;emergencyActive=false;
    setControls(true);
    calibrateBtn.disabled=false;printBtn.disabled=true;
  }else{
    calibrated=false;emergencyActive=false;
    setControls(false);
  }
  updateStatus();
};

/* Calibrate */
calibrateBtn.onclick=()=>{
  if(!powerOn||emergencyActive)return;
  statusBar.textContent="CALIBRATION IN PROGRESS";
  statusBar.className="status-bar printing";
  systemLED.className="led-indicator yellow";
  calibrateBtn.disabled=true;
  setTimeout(()=>{
    calibrated=true;
    calibrateBtn.disabled=false;printBtn.disabled=false;
    updateStatus();
  },2000);
};

/* Print */
printBtn.onclick=()=>{
  if(!powerOn||!calibrated||emergencyActive)return;
  statusBar.textContent="PRINTING IN PROGRESS";
  statusBar.className="status-bar printing";
  textOverlay.style.visibility="hidden";
  setTimeout(()=>{textOverlay.style.visibility="visible";updateStatus();},2000);
};

/* Reset */
resetBtn.onclick=()=>{
  if(!powerOn)return;
  calibrated=false;emergencyActive=false;
  calibrateBtn.disabled=false;printBtn.disabled=true;
  updateStatus();
};

/* Emergency Stop */
emergencyBtn.onclick=()=>{
  emergencyActive=!emergencyActive;
  if(emergencyActive){
    setControls(false);
    powerBtn.disabled=false;settingsBtn.disabled=false;
  }else{
    setControls(powerOn);
    printBtn.disabled=!calibrated;
  }
  updateStatus();
};

/* Font controls */
fontSelect.onchange=()=>textOverlay.style.fontFamily=fontSelect.value;
fontSizeRange.oninput=e=>textOverlay.style.fontSize=e.target.value+"px";

/* Drag / Edit */
let isDragging=false,offsetX=0,offsetY=0,editMode=false;
textOverlay.addEventListener("dblclick",()=>{
  editMode=!editMode;textOverlay.contentEditable=editMode;
  textOverlay.classList.toggle("editing",editMode);
  if(editMode)textOverlay.focus();
});
textOverlay.addEventListener("mousedown",(e)=>{
  if(editMode)return;
  isDragging=true;textOverlay.style.cursor="grabbing";
  const r=textOverlay.getBoundingClientRect();
  offsetX=e.clientX-r.left;offsetY=e.clientY-r.top;e.preventDefault();
});
window.addEventListener("mouseup",()=>{
  isDragging=false;textOverlay.style.cursor=editMode?"text":"grab";
});
window.addEventListener("mousemove",(e)=>{
  if(!isDragging)return;
  const rect=viewport.getBoundingClientRect();
  let x=e.clientX-offsetX-rect.left;
  let y=e.clientY-offsetY-rect.top;
  x=Math.max(0,Math.min(x,rect.width-textOverlay.offsetWidth));
  y=Math.max(0,Math.min(y,rect.height-textOverlay.offsetHeight));
  textOverlay.style.left=x+"px";
  textOverlay.style.top=y+"px";
});

updateStatus();
</script>
</body>
</html>